!    -*- f90 -*-
! Note: the context of this file is case sensitive.

python module synth__user__routines 
    interface synth_user_interface 
        subroutine tennisball ! in :MoogStokesPy_Alpha:Synth.f:synth:unknown_interface
            intent(callback,hide) tennisball
        end subroutine tennisball
    end interface synth_user_interface
end python module synth__user__routines
python module synspec__user__routines 
    interface synspec_user_interface 
        subroutine recorder(wave,e_d_n_err) ! in :MoogStokesPy_Alpha:Synspec.f:synspec:unknown_interface
            intent(callback,hide) recorder
            real*8 :: wave
            real*8 :: e_d_n_err
        end subroutine recorder
    end interface synspec_user_interface
end python module synspec__user__routines
python module synstokes__user__routines 
    interface synstokes_user_interface 
        subroutine stokesrecorder(e_1_err,wave,stokes,continuum) ! in :MoogStokesPy_Alpha:SynStokes.f:synstokes:unknown_interface
            intent(callback,hide) stokesrecorder
            integer :: e_1_err
            real*8 :: wave
            real*8 dimension(4) :: stokes
            real*8 :: continuum
        end subroutine stokesrecorder
        subroutine beachball ! in :MoogStokesPy_Alpha:SynStokes.f:synstokes:unknown_interface
            intent(callback,hide) beachball
        end subroutine beachball
        subroutine diskoball ! in :MoogStokesPy_Alpha:SynStokes.f:synstokes:unknown_interface
            intent(callback,hide) diskoball
        end subroutine diskoball
    end interface synstokes_user_interface
end python module synstokes__user__routines
python module stokesdipstick__user__routines 
    interface stokesdipstick_user_interface 
        subroutine fluxtracer(logtau,dtau,stokes,continuum) ! in :MoogStokesPy_Alpha:StokesDipStick.f:stokesdipstick:unknown_interface
            intent(callback,hide) fluxtracer
            real*8 :: logtau
            real*8 :: dtau
            real*8 dimension(4) :: stokes
            real*8 :: continuum
        end subroutine fluxtracer
    end interface stokesdipstick_user_interface
end python module stokesdipstick__user__routines
python module MoogStokesPy_Alpha ! in 
    interface  ! in :MoogStokesPy_Alpha
        subroutine moogstokessilent ! in :MoogStokesPy_Alpha:MoogStokessilent.f
            use synspec__user__routines
            use synstokes__user__routines
            use stokesdipstick__user__routines
            use synth__user__routines
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            intent(callback, hide) recorder
            external recorder
            intent(callback, hide) tennisball
            external tennisball
            intent(callback, hide) beachball
            external beachball
            intent(callback, hide) diskoball
            external diskoball
            intent(callback, hide) stokesrecorder
            external stokesrecorder
            intent(callback, hide) fluxtracer
            external fluxtracer
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine moogstokessilent
        subroutine begin ! in :MoogStokesPy_Alpha:Begin.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine begin
        subroutine infile(type_bn,iunit,mode,irec,charcount,fname,line) ! in :MoogStokesPy_Alpha:Infile.f
            character*7 :: type_bn
            integer :: iunit
            character*11 :: mode
            integer :: irec
            integer :: charcount
            character*80 :: fname
            integer :: line
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine infile
        subroutine getasci(num,line) ! in :MoogStokesPy_Alpha:Getasci.f
            integer :: num
            integer :: line
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine getasci
        function ivcleof(y,x) ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: y
            integer :: x
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            integer :: ivcleof
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end function ivcleof
        function ivwrite(y,x,arr,ccount) ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: y
            integer :: x
            character*79 :: arr
            integer :: ccount
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            integer :: ivwrite
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end function ivwrite
        function ivmove(y,x) ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: y
            integer :: x
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            integer :: ivmove
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end function ivmove
        function ivcleol() ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: ivcleol
        end function ivcleol
        function ivbold(on) ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: on
            integer :: ivbold
        end function ivbold
        function ivundl(on) ! in :MoogStokesPy_Alpha:Nansi.f
            integer :: on
            integer :: ivundl
        end function ivundl
        subroutine getcount(num,linechars) ! in :MoogStokesPy_Alpha:Getcount.f
            integer :: num
            character*60 :: linechars
        end subroutine getcount
        subroutine synth ! in :MoogStokesPy_Alpha:Synth.f
            use synth__user__routines
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            intent(callback) tennisball
            external tennisball
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine synth
        subroutine synspec ! in :MoogStokesPy_Alpha:Synspec.f
            use synspec__user__routines
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            intent(callback) recorder
            external recorder
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
        end subroutine synspec
        subroutine finish(number) ! in :MoogStokesPy_Alpha:Finish.f
            integer :: number
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine finish
        subroutine opacit(modeop,waveop) ! in :MoogStokesPy_Alpha:Opacit.f
            integer :: modeop
            real*8 :: waveop
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
            common /dummy/ dummy1,dummy2,dummy3,dummy4
        end subroutine opacit
        subroutine opach1 ! in :MoogStokesPy_Alpha:OpacHydrogen.f
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            common /eqdata/ amol,datmol,const
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
        end subroutine opach1
        subroutine opachminus ! in :MoogStokesPy_Alpha:OpacHydrogen.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opachminus
        subroutine linter(xold,yold,nold,xnew,ynew,nnew) ! in :MoogStokesPy_Alpha:OpacHydrogen.f
            real*8 dimension(*) :: xold
            real*8 dimension(*) :: yold
            integer :: nold
            real*8 dimension(*) :: xnew
            real*8 dimension(*) :: ynew
            integer :: nnew
        end subroutine linter
        function map1(xold,fold,nold,xnew,fnew,nnew) ! in :MoogStokesPy_Alpha:OpacHydrogen.f
            real*8 dimension(*) :: xold
            real*8 dimension(*) :: fold
            integer :: nold
            real*8 dimension(*) :: xnew
            real*8 dimension(*) :: fnew
            integer :: nnew
            integer :: map1
        end function map1
        subroutine opacheminus ! in :MoogStokesPy_Alpha:OpacHelium.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacheminus
        subroutine opacc1 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacc1
        subroutine opacmg1 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacmg1
        subroutine opacmg2 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacmg2
        subroutine opacal1 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacal1
        subroutine opacsi1 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacsi1
        subroutine opacsi2 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacsi2
        subroutine opacfe1 ! in :MoogStokesPy_Alpha:Opacmetals.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacfe1
        function seaton(freq0,xsect,power,a) ! in :MoogStokesPy_Alpha:Opacmetals.f
            real*8 :: freq0
            real*8 :: xsect
            real*8 :: power
            real*8 :: a
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 :: seaton
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end function seaton
        subroutine opacescat ! in :MoogStokesPy_Alpha:Opacscat.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
        end subroutine opacescat
        subroutine opachscat ! in :MoogStokesPy_Alpha:Opacscat.f
            character dimension(2500,7),intent(c) :: damptype
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /lindamp/ damptype
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine opachscat
        subroutine opach2scat ! in :MoogStokesPy_Alpha:Opacscat.f
            character dimension(2500,7),intent(c) :: damptype
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /lindamp/ damptype
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine opach2scat
        subroutine opachescat ! in :MoogStokesPy_Alpha:Opacscat.f
            character dimension(2500,7),intent(c) :: damptype
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100) :: ah1
            real*8 dimension(100) :: ahminus
            real*8 dimension(100) :: aheminus
            real*8 dimension(100) :: sigel
            real*8 dimension(100) :: sigh
            real*8 dimension(100) :: sigh2
            real*8 dimension(100) :: sighe
            real*8 dimension(100) :: ac1
            real*8 dimension(100) :: amg1
            real*8 dimension(100) :: amg2
            real*8 dimension(100) :: aal1
            real*8 dimension(100) :: asi1
            real*8 dimension(100) :: asi2
            real*8 dimension(100) :: afe1
            real*8 dimension(100) :: evhkt
            real*8 :: freq
            real*8 :: freqlg
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /lindamp/ damptype
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /kappa/ ah1,ahminus,aheminus,sigel,sigh,sigh2,sighe,ac1,amg1,amg2,aal1,asi1,asi2,afe1,evhkt,freq,freqlg
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine opachescat
        function coulx(n,freq,z) ! in :MoogStokesPy_Alpha:Opaccouls.f
            integer :: n
            real*8 :: freq
            real*8 :: z
            real*8 :: coulx
        end function coulx
        function coulbf1s(freq,z) ! in :MoogStokesPy_Alpha:Opaccouls.f
            real*8 :: freq
            real*8 :: z
            real*8 :: coulbf1s
        end function coulbf1s
        function coulff(nz,tlog,freq) ! in :MoogStokesPy_Alpha:Opaccouls.f
            integer :: nz
            real*8 :: tlog
            real*8 :: freq
            real*8 :: coulff
        end function coulff
        subroutine nearly(numpass) ! in :MoogStokesPy_Alpha:Nearly.f
            integer :: numpass
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
        end subroutine nearly
        subroutine eqlib ! in :MoogStokesPy_Alpha:Eqlib.f
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /eqdata/ amol,datmol,const
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
        end subroutine eqlib
        function partnew(atom,k,level) ! in :MoogStokesPy_Alpha:Partnew.f
            real*8 :: atom
            integer :: k
            integer :: level
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 :: partnew
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
        end function partnew
        subroutine cdcalc(number) ! in :MoogStokesPy_Alpha:Cdcalc.f
            integer :: number
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /lindamp/ damptype
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine cdcalc
        function expint(x,n) ! in :MoogStokesPy_Alpha:Jexpint.f
            real*8 :: x
            integer :: n
            real*8 :: expint
        end function expint
        subroutine linlimit ! in :MoogStokesPy_Alpha:Linlimit.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character dimension(2500,7),intent(c) :: damptype
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /lindamp/ damptype
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine linlimit
        subroutine prinfo(line) ! in :MoogStokesPy_Alpha:Prinfo.f
            integer :: line
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine prinfo
        subroutine sunder(amol,i1,i2) ! in :MoogStokesPy_Alpha:Sunder.f
            real*8 :: amol
            integer :: i1
            integer :: i2
        end subroutine sunder
        subroutine gammabark ! in :MoogStokesPy_Alpha:Gammabark.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(10000) :: wavebk
            real*8 dimension(10000) :: idbk
            real*8 dimension(10000) :: gammabk
            real*8 dimension(10000) :: alphabk
            real*8 :: wavemin
            real*8 :: wavemax
            integer, optional :: firstread=0
            integer :: numbark
            integer :: nummin
            integer :: nummax
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /dampdat/ wavebk,idbk,gammabk,alphabk,wavemin,wavemax,firstread,numbark,nummin,nummax
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
        end subroutine gammabark
        function rinteg(x,f,fint,n,start) ! in :MoogStokesPy_Alpha:Rinteg.f
            real*8 dimension(5000) :: x
            real*8 dimension(5000) :: f
            real*8 dimension(5000) :: fint
            integer :: n
            real*8 :: start
            real*8 :: rinteg
        end function rinteg
        subroutine parcoe(f,x,a,b,c,n) ! in :MoogStokesPy_Alpha:Rinteg.f
            real*8 dimension(5000) :: f
            real*8 dimension(5000) :: x
            real*8 dimension(5000) :: a
            real*8 dimension(5000) :: b
            real*8 dimension(5000) :: c
            integer :: n
        end subroutine parcoe
        block data atomic ! in :MoogStokesPy_Alpha:Batom.f
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character, optional,dimension(95,2),intent(c) :: names='h '
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8, optional,dimension(95) :: xsolar=12.00
            real*8, optional,dimension(95) :: xam=1.008
            real*8 dimension(50,6) :: newpartdata
            real*8, optional,dimension(95) :: xchi1=13.60
            real*8, optional,dimension(95) :: xchi2=50.00
            real*8, optional,dimension(95) :: xchi3=90.00
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
        end block data atomic
        block data molec ! in :MoogStokesPy_Alpha:Bmolec.f
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            real*8 dimension(6,110) :: const_bn
            common /eqdata/ amol,datmol,const
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
        end block data molec
        subroutine inlines(num) ! in :MoogStokesPy_Alpha:Inlines.f
            integer :: num
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine inlines
        subroutine params ! in :MoogStokesPy_Alpha:Params.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(2,95,5) :: binpecabund
            real*8 dimension(2,95) :: binpec
            real*8 :: fluxprimary
            real*8 :: fluxsecondary
            real*8 :: lumratio
            real*8 :: deltaradvel
            integer :: begin
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            character dimension(2,80),intent(c) :: modbin
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer, optional :: linecount=0
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            real*8 dimension(9) :: disp
            real*8 :: bzero
            real*8 :: bscale
            integer :: ibits
            integer :: nblock
            integer :: naxis
            integer :: naxis1
            integer :: byteswap
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /binstuff/ binpecabund,binpec,fluxprimary,fluxsecondary,lumratio,deltaradvel,begin
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /binchars/ modbin
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /obspars/ disp,bzero,bscale,ibits,nblock,naxis,naxis1,byteswap
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine params
        subroutine putasci(num,line) ! in :MoogStokesPy_Alpha:Putasci.f
            integer :: num
            integer :: line
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
        end subroutine putasci
        subroutine taukap ! in :MoogStokesPy_Alpha:Taukap.f
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /lindamp/ damptype
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine taukap
        function voigt(a,v) ! in :MoogStokesPy_Alpha:Voigt.f
            real*8 :: a
            real*8 :: v
            real*8 :: voigt
        end function voigt
        subroutine discov(amol,i1,i2) ! in :MoogStokesPy_Alpha:Discov.f
            real*8 :: amol
            integer :: i1
            integer :: i2
        end subroutine discov
        subroutine inmodel ! in :MoogStokesPy_Alpha:Inmodel.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
        end subroutine inmodel
        subroutine partfn(atom,jmark) ! in :MoogStokesPy_Alpha:Partfn.f
            real*8 :: atom
            integer :: jmark
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /lindamp/ damptype
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine partfn
        subroutine damping(linnumber) ! in :MoogStokesPy_Alpha:Damping.f
            integer :: linnumber
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /lindamp/ damptype
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine damping
        function ucalc(atom,level) ! in :MoogStokesPy_Alpha:Ucalc.f
            real*8 :: atom
            integer :: level
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 :: ucalc
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
        end function ucalc
        subroutine invert(order,a,i,nsiz) ! in :MoogStokesPy_Alpha:Invert.f
            integer :: order
            real*8 dimension(nsiz,nsiz) :: a
            real*8 dimension(nsiz,nsiz),depend(nsiz,nsiz) :: i
            integer, optional,check(shape(a,0)==nsiz),depend(a) :: nsiz=shape(a,0)
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
        end subroutine invert
        subroutine trudamp(linnum) ! in :MoogStokesPy_Alpha:Trudamp.f
            integer :: linnum
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /lindamp/ damptype
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end subroutine trudamp
        subroutine lineinfo(number) ! in :MoogStokesPy_Alpha:Lineinfo.f
            integer :: number
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(95) :: xsolar
            real*8 dimension(95) :: xam
            real*8 dimension(50,6) :: newpartdata
            real*8 dimension(95) :: xchi1
            real*8 dimension(95) :: xchi2
            real*8 dimension(95) :: xchi3
            integer dimension(6,380) :: nudata
            integer dimension(95,4) :: partflag
            integer :: nu
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /quants/ xsolar,xam,newpartdata,xchi1,xchi2,xchi3,nudata,partflag,nu
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
        end subroutine lineinfo
        subroutine synstokes ! in :MoogStokesPy_Alpha:SynStokes.f
            use synstokes__user__routines
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            intent(callback) beachball
            external beachball
            intent(callback) stokesrecorder
            external stokesrecorder
            intent(callback) diskoball
            external diskoball
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine synstokes
        subroutine spline(x,y,n,yp1,ypn,y2) ! in :MoogStokesPy_Alpha:Spline.f
            real*8 dimension(n) :: x
            real*8 dimension(n),depend(n) :: y
            integer, optional,check(len(x)>=n),depend(x) :: n=len(x)
            real*8 :: yp1
            real*8 :: ypn
            real*8 dimension(n),depend(n) :: y2
        end subroutine spline
        subroutine splint(xa,ya,y2a,n,x,y) ! in :MoogStokesPy_Alpha:Spline.f
            real*8 dimension(n) :: xa
            real*8 dimension(n),depend(n) :: ya
            real*8 dimension(n),depend(n) :: y2a
            integer, optional,check(len(xa)>=n),depend(xa) :: n=len(xa)
            real*8 :: x
            real*8 :: y
        end subroutine splint
        subroutine spl_def(npts,x,y,knots,nknots,coeffs) ! in :MoogStokesPy_Alpha:SplineDriver.f
            integer, optional,check(len(x)>=npts),depend(x) :: npts=len(x)
            real*8 dimension(npts) :: x
            real*8 dimension(npts),depend(npts) :: y
            real*8 dimension(npts + 4),depend(npts) :: knots
            integer :: nknots
            real*8 dimension(npts + 4),depend(npts) :: coeffs
        end subroutine spl_def
        function spl_ev(knots,nknots,coeffs,x_new) ! in :MoogStokesPy_Alpha:SplineDriver.f
            real*8 dimension(nknots) :: knots
            integer, optional,check(len(knots)>=nknots),depend(knots) :: nknots=len(knots)
            real*8 dimension(nknots),depend(nknots) :: coeffs
            real*8 :: x_new
            real*8 :: spl_ev
        end function spl_ev
        subroutine wavegrid ! in :MoogStokesPy_Alpha:WaveGrid.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine wavegrid
        subroutine sortwave ! in :MoogStokesPy_Alpha:WaveGrid.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine sortwave
        subroutine curfit(iopt,m,x,y,w,xb,xe,k,s,nest,n,t,c,fp,wrk,lwrk,iwrk,ier) ! in :MoogStokesPy_Alpha:Curfit.f
            integer :: iopt
            integer, optional,check(len(x)>=m),depend(x) :: m=len(x)
            real*8 dimension(m) :: x
            real*8 dimension(m),depend(m) :: y
            real*8 dimension(m),depend(m) :: w
            real*8 :: xb
            real*8 :: xe
            integer :: k
            real*8 :: s
            integer, optional,check(len(t)>=nest),depend(t) :: nest=len(t)
            integer :: n
            real*8 dimension(nest) :: t
            real*8 dimension(nest),depend(nest) :: c
            real*8 :: fp
            real*8 dimension(lwrk) :: wrk
            integer, optional,check(len(wrk)>=lwrk),depend(wrk) :: lwrk=len(wrk)
            integer dimension(nest),depend(nest) :: iwrk
            integer :: ier
        end subroutine curfit
        subroutine fpback(a,z,n,k,c,nest) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(nest,k) :: a
            real*8 dimension(n) :: z
            integer, optional,check(len(z)>=n),depend(z) :: n=len(z)
            integer, optional,check(shape(a,1)==k),depend(a) :: k=shape(a,1)
            real*8 dimension(n),depend(n) :: c
            integer, optional,check(shape(a,0)==nest),depend(a) :: nest=shape(a,0)
        end subroutine fpback
        subroutine fpbspl(t,n,k,x,l,h) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(n) :: t
            integer, optional,check(len(t)>=n),depend(t) :: n=len(t)
            integer :: k
            real*8 :: x
            integer :: l
            real*8 dimension(6) :: h
        end subroutine fpbspl
        subroutine fpchec(x,m,t,n,k,ier) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(m) :: x
            integer, optional,check(len(x)>=m),depend(x) :: m=len(x)
            real*8 dimension(n) :: t
            integer, optional,check(len(t)>=n),depend(t) :: n=len(t)
            integer :: k
            integer :: ier
        end subroutine fpchec
        subroutine fpcurf(iopt,x,y,w,m,xb,xe,k,s,nest,tol,maxit,k1,k2,n,t,c,fp,fpint,z,a,b,g,q,nrdata,ier) ! in :MoogStokesPy_Alpha:Curfit.f
            integer :: iopt
            real*8 dimension(m) :: x
            real*8 dimension(m),depend(m) :: y
            real*8 dimension(m),depend(m) :: w
            integer, optional,check(len(x)>=m),depend(x) :: m=len(x)
            real*8 :: xb
            real*8 :: xe
            integer :: k
            real*8 :: s
            integer, optional,check(len(t)>=nest),depend(t) :: nest=len(t)
            real*8 :: tol
            integer :: maxit
            integer, optional,check(shape(a,1)==k1),depend(a) :: k1=shape(a,1)
            integer, optional,check(shape(b,1)==k2),depend(b) :: k2=shape(b,1)
            integer :: n
            real*8 dimension(nest) :: t
            real*8 dimension(nest),depend(nest) :: c
            real*8 :: fp
            real*8 dimension(nest),depend(nest) :: fpint
            real*8 dimension(nest),depend(nest) :: z
            real*8 dimension(nest,k1),depend(nest) :: a
            real*8 dimension(nest,k2),depend(nest) :: b
            real*8 dimension(nest,k2),depend(nest,k2) :: g
            real*8 dimension(m,k1),depend(m,k1) :: q
            integer dimension(nest),depend(nest) :: nrdata
            integer :: ier
        end subroutine fpcurf
        subroutine fpdisc(t,n,k2,b,nest) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(n) :: t
            integer, optional,check(len(t)>=n),depend(t) :: n=len(t)
            integer, optional,check(shape(b,1)==k2),depend(b) :: k2=shape(b,1)
            real*8 dimension(nest,k2) :: b
            integer, optional,check(shape(b,0)==nest),depend(b) :: nest=shape(b,0)
        end subroutine fpdisc
        subroutine fpgivs(piv,ww,cos,sin) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 :: piv
            real*8 :: ww
            real*8 :: cos
            real*8 :: sin
        end subroutine fpgivs
        subroutine fpknot(x,m,t,n,fpint,nrdata,nrint,nest,istart) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(m) :: x
            integer, optional,check(len(x)>=m),depend(x) :: m=len(x)
            real*8 dimension(nest) :: t
            integer :: n
            real*8 dimension(nest),depend(nest) :: fpint
            integer dimension(nest),depend(nest) :: nrdata
            integer :: nrint
            integer, optional,check(len(t)>=nest),depend(t) :: nest=len(t)
            integer :: istart
        end subroutine fpknot
        function fprati(p1,f1,p2,f2,p3,f3) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 :: p1
            real*8 :: f1
            real*8 :: p2
            real*8 :: f2
            real*8 :: p3
            real*8 :: f3
            real*8 :: fprati
        end function fprati
        subroutine fprota(cos,sin,a,b) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 :: cos
            real*8 :: sin
            real*8 :: a
            real*8 :: b
        end subroutine fprota
        subroutine splev(t,n,c,k,x,y,m,ier) ! in :MoogStokesPy_Alpha:Curfit.f
            real*8 dimension(n) :: t
            integer, optional,check(len(t)>=n),depend(t) :: n=len(t)
            real*8 dimension(n),depend(n) :: c
            integer :: k
            real*8 dimension(m) :: x
            real*8 dimension(m),depend(m) :: y
            integer, optional,check(len(x)>=m),depend(x) :: m=len(x)
            integer :: ier
        end subroutine splev
        subroutine calcgeom(az,long_bn,phi_ang,chi_ang,mu) ! in :MoogStokesPy_Alpha:CalcGeom.f
            real*8 :: az
            real*8 :: long_bn
            real*8 :: phi_ang
            real*8 :: chi_ang
            real*8 :: mu
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
        end subroutine calcgeom
        subroutine tracestokes(phi_ang,chi_ang,mu) ! in :MoogStokesPy_Alpha:DELOQuad.f
            real*8 :: phi_ang
            real*8 :: chi_ang
            real*8 :: mu
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine tracestokes
        subroutine interp_opacities(logtau,k_interp,k_ord,e_interp,e_ord,tau_interp,tau_interp_c,mu,deltau) ! in :MoogStokesPy_Alpha:DELOQuad.f
            real*8 :: logtau
            real*8 dimension(4,4,2) :: k_interp
            integer :: k_ord
            real*8 dimension(4,3) :: e_interp
            integer :: e_ord
            real*8 dimension(3) :: tau_interp
            real*8 dimension(3) :: tau_interp_c
            real*8 :: mu
            real*8 :: deltau
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine interp_opacities
        function planck(temperature) ! in :MoogStokesPy_Alpha:DELOQuad.f
            real*8 :: temperature
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 :: planck
            common /lindamp/ damptype
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
        end function planck
        subroutine calcopacities ! in :MoogStokesPy_Alpha:CalcOpacities.f
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine calcopacities
        function w4(z) ! in :MoogStokesPy_Alpha:ComplexVoigt.f
            complex :: z
            complex :: w4
        end function w4
        subroutine stokestrace ! in :MoogStokesPy_Alpha:StokesTrace.f
            real*8 :: xxm1
            real*8 :: xxb1
            real*8 :: xxr1
            real*8 :: xxm2
            real*8 :: xxb2
            real*8 :: xxr2
            real*8 :: xxm3
            real*8 :: xxb3
            real*8 :: xxr3
            real*8 :: deltaep
            real*8 :: deltarw
            real*8 :: deltawv
            real*8 dimension(1000) :: p
            real*8 dimension(1000) :: prot
            real*8 dimension(1000) :: pmac
            real*8 :: vsini
            real*8 :: limbdark
            real*8 :: vmac
            real*8 :: fwhmgauss
            real*8 :: fwhmloren
            real*8 :: oldvsini
            real*8 :: oldlimbdark
            real*8 :: oldvmac
            real*8 :: oldfwhmgauss
            real*8 :: oldfwhmloren
            real*8 :: origvsini
            real*8 :: origlimbdark
            real*8 :: origvmac
            real*8 :: origfwhmgauss
            real*8 :: origfwhmloren
            real*8 :: half
            real*8 :: power
            real*8 :: powerrot
            real*8 :: powermac
            real*8 :: average
            real*8 :: deviate
            real*8 :: oldhalf
            real*4 dimension(100000) :: xobs
            real*4 dimension(100000) :: yobs
            real*4 :: xlo
            real*4 :: xhi
            real*4 :: ylo
            real*4 :: yhi
            real*4 :: origxlo
            real*4 :: origxhi
            real*4 :: origylo
            real*4 :: origyhi
            real*4 :: oldxlo
            real*4 :: oldxhi
            real*4 :: oldylo
            real*4 :: oldyhi
            real*4 :: xadd
            real*4 :: yadd
            real*4 :: ymult
            real*4 :: veladd
            real*4 :: deltavel
            real*4 :: origxadd
            real*4 :: origyadd
            real*4 :: origymult
            real*4 :: origveladd
            real*4 :: oldxadd
            real*4 :: oldyadd
            real*4 :: oldymult
            real*4 :: oldveladd
            real*4 :: bigxtic
            real*4 :: bigytic
            real*4 :: smlxtic
            real*4 :: smlytic
            real*4 :: xplotpos
            real*4 :: yplotpos
            real*4 :: addflux
            real*4 :: ydelta
            integer :: lount
            integer :: kount
            integer :: nsyn
            integer :: lim1obs
            integer :: lim2obs
            integer :: iterm
            integer :: iscale
            integer :: maxline
            integer :: histoyes
            integer :: deviations
            integer :: syncount
            integer :: kounter
            integer :: maxshift
            character*400 :: abitle
            character*240 :: isoitle
            character*80 :: smterm
            character*80 :: smtotalterm
            character*80 :: smt1
            character*80 :: smt2
            character*80 :: moditle
            character*80 :: obsitle
            character*80 :: linitle
            character*80 :: smitle
            character*80 :: array
            character*80 :: chinfo
            character*80 :: errmess
            character*80 :: plotroutine
            character*4 :: whichwin
            character*4 :: origwhichwin
            character*4 :: oldwhichwin
            character*1 :: choice
            character*1 :: smtype
            character*1 :: oldsmtype
            character*1 :: origsmtype
            character*1 :: gaussflag
            character*1 :: rotateflag
            character*1 :: lorenflag
            character*1 :: macroflag
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(110) :: amol
            real*8 dimension(7,110) :: datmol
            real*8 :: const
            real*8 dimension(95,5) :: pecabund
            real*8 dimension(95,5) :: newpecabund
            real*8 dimension(5) :: abfactor
            integer dimension(95) :: pec
            integer dimension(95) :: newpec
            integer :: numpecatom
            integer :: newnumpecatom
            integer :: numatomsyn
            integer :: newnumatomsyn
            integer :: isynth
            integer :: ninetynineflag
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 dimension(20) :: isotope
            real*8 dimension(20) :: newisotope
            real*8 dimension(20,5) :: isoabund
            real*8 dimension(20,5) :: newisoabund
            integer :: numiso
            integer :: newnumiso
            integer :: numisosyn
            integer :: newnumisosyn
            integer :: isorun
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            real*8 dimension(110) :: pmol
            real*8 dimension(110,100) :: xmol
            real*8 dimension(30) :: xatom
            real*8 dimension(30) :: patom
            real*8 dimension(30,100) :: xamol
            integer :: neq
            integer :: lev
            integer :: nmol
            integer :: natoms
            integer dimension(30) :: iorder
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            common /pstuff/ xxm1,xxb1,xxr1,xxm2,xxb2,xxr2,xxm3,xxb3,xxr3,deltaep,deltarw,deltawv,p,prot,pmac,vsini,limbdark,vmac,fwhmgauss,fwhmloren,oldvsini,oldlimbdark,oldvmac,oldfwhmgauss,oldfwhmloren,origvsini,origlimbdark,origvmac,origfwhmgauss,origfwhmloren,half,power,powerrot,powermac,average,deviate,oldhalf,xobs,yobs,xlo,xhi,ylo,yhi,origxlo,origxhi,origylo,origyhi,oldxlo,oldxhi,oldylo,oldyhi,xadd,yadd,ymult,veladd,deltavel,origxadd,origyadd,origymult,origveladd,oldxadd,oldyadd,oldymult,oldveladd,bigxtic,bigytic,smlxtic,smlytic,xplotpos,yplotpos,addflux,ydelta,lount,kount,nsyn,lim1obs,lim2obs,iterm,iscale,maxline,histoyes,deviations,syncount,kounter,maxshift
            common /cstuff/ abitle,isoitle,smterm,smtotalterm,smt1,smt2,moditle,obsitle,linitle,smitle,array,chinfo,errmess,plotroutine,whichwin,origwhichwin,oldwhichwin,choice,smtype,oldsmtype,origsmtype,gaussflag,rotateflag,lorenflag,macroflag
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /eqdata/ amol,datmol,const
            common /newfact/ pecabund,newpecabund,abfactor,pec,newpec,numpecatom,newnumpecatom,numatomsyn,newnumatomsyn,isynth,ninetynineflag
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /iso/ isotope,newisotope,isoabund,newisoabund,numiso,newnumiso,numisosyn,newnumisosyn,isorun
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
            common /mol/ pmol,xmol,xatom,patom,xamol,neq,lev,nmol,natoms,iorder
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine stokestrace
        subroutine stokesdipstick(phi_ang,chi_ang,mu) ! in :MoogStokesPy_Alpha:StokesDipStick.f
            use stokesdipstick__user__routines
            real*8 :: phi_ang
            real*8 :: chi_ang
            real*8 :: mu
            real*8 dimension(100) :: dummy1
            real*8 dimension(100) :: dummy2
            real*8 dimension(5000) :: dummy3
            real*8 dimension(5000) :: dummy4
            real*8 dimension(2500,100) :: a
            real*8 dimension(2500,100) :: dopp
            real*8 dimension(2500,100) :: kapnu0
            real*8 dimension(2500) :: deltamj
            real*8 dimension(2500) :: crad
            real*8 dimension(2500) :: c4
            real*8 dimension(2500) :: gf
            real*8 dimension(2500) :: wave1
            real*8 dimension(2500) :: atom1
            real*8 dimension(2500,2) :: e
            real*8 dimension(2500,3) :: chi
            real*8 dimension(2500) :: amass
            real*8 dimension(2500) :: charge
            real*8 dimension(2500) :: d0
            real*8 dimension(2500) :: dampnum
            real*8 dimension(2500) :: gf1
            real*8 dimension(2500) :: width
            real*8 dimension(2500) :: abundout
            real*8 dimension(2500) :: widout
            real*8 dimension(2500) :: strength
            real*8 dimension(2500) :: rdmass
            real*8 dimension(2500) :: gambark
            real*8 dimension(2500) :: alpbark
            real*8 dimension(2500) :: wid1comp
            real*8 dimension(100) :: kapnu
            real*8 dimension(100) :: taunu
            real*8 dimension(100) :: cd
            real*8 dimension(100) :: sline
            real*8 dimension(5000) :: d
            real*8 dimension(400) :: dellam
            real*8 dimension(100) :: w
            real*8 dimension(3000) :: rwtab
            real*8 dimension(3000) :: gftab
            real*8 :: gfhold
            real*8 :: delta
            real*8 :: start
            real*8 :: sstop
            real*8 :: step
            real*8 :: oldstart
            real*8 :: oldstop
            real*8 :: oldstep
            real*8 :: olddelta
            real*8 :: dipstickwave
            real*8 :: rwlow
            real*8 :: rwhigh
            real*8 :: rwstep
            real*8 :: wavestep
            real*8 :: cogatom
            real*8 :: delwave
            real*8 :: wave
            real*8 :: waveold
            real*8 :: st1
            real*8 :: gammatot
            real*8 :: gammav
            real*8 :: gammas
            real*8 :: gammar
            real*8 :: viewang
            integer :: lim1
            integer :: lim2
            integer :: mode
            integer :: ndepths
            integer :: ncurve
            integer :: nlines
            integer :: nstrong
            integer :: lim1line
            integer :: iaa
            integer :: ibb
            integer :: lim2line
            integer :: ntabtot
            integer dimension(2500) :: group
            integer :: iabatom
            integer :: molflag
            integer :: dostrong
            integer :: gfstyle
            real*8 dimension(100) :: t
            real*8 dimension(100) :: theta
            real*8 dimension(100) :: tkev
            real*8 dimension(100) :: tlog
            real*8 dimension(100) :: pgas
            real*8 dimension(100) :: ne
            real*8 dimension(100) :: nhtot
            real*8 dimension(8,2,100) :: numdens
            real*8 dimension(100) :: molweight
            real*8 dimension(100) :: vturb
            real*8 dimension(100) :: scont
            real*8 dimension(100) :: kapref
            real*8 dimension(100) :: kaplam
            real*8 dimension(100) :: tauref
            real*8 dimension(100) :: taulam
            real*8 dimension(100) :: kaplamabs
            real*8 dimension(100) :: kaplamsca
            real*8 dimension(100) :: rho
            real*8 dimension(100) :: rhox
            real*8 dimension(100) :: xref
            real*8 dimension(100) :: xdepth
            real*8 dimension(95) :: elem
            real*8 dimension(95) :: xabund
            real*8 dimension(95) :: xabu
            real*8 dimension(95,4,100) :: u
            real*8 :: flux
            real*8 :: fudge
            real*8 :: wavref
            real*8 :: abscale
            real*8 :: deltaabund
            integer :: ntau
            integer :: jtau5
            integer :: iunits
            integer :: itru
            integer :: iraf
            integer :: modelnum
            integer :: nfparam
            integer :: nfmodel
            integer :: nflines
            integer :: nfslines
            integer :: nfobs
            integer :: nftable
            integer :: nf1out
            integer :: nf2out
            integer :: nf3out
            integer :: nf4out
            integer :: nf5out
            integer :: nf6out
            integer :: nf7out
            integer :: nf8out
            integer :: nf9out
            integer :: nf10out
            integer :: nfbarklem
            integer :: nfbarklemuv
            integer :: modprintopt
            integer :: molopt
            integer :: linprintopt
            integer :: linprintalt
            integer :: fluxintopt
            integer :: plotopt
            integer :: dampingopt
            integer :: specfileopt
            integer :: linfileopt
            integer :: printstrong
            integer :: linecount
            integer :: oldcount
            integer :: scatopt
            real*8 :: inclination
            real*8 :: clocking
            real*8 :: position_angle
            real*8 dimension(1000) :: azimuth
            real*8 dimension(1000) :: longitude
            real*8 dimension(3) :: b_sph
            real*8 dimension(3) :: b_xyz
            real*8 dimension(3,3) :: t_rho
            real*8 dimension(3,3) :: t_eta
            real*8 dimension(3,3) :: t_i
            real*8 dimension(3,3) :: rotation_matrix
            real*8 dimension(3,3) :: zeros
            real*8 dimension(1000) :: chi_angle
            real*8 dimension(1000) :: phi_angle
            real*8 dimension(1000) :: mus
            integer :: nrings
            integer :: ncells
            integer :: testflag
            integer :: diskflag
            character*80 :: f1out
            character*80 :: f2out
            character*80 :: f3out
            character*80 :: f4out
            character*80 :: f5out
            character*80 :: f6out
            character*80 :: f7out
            character*80 :: f8out
            character*80 :: f9out
            character*80 :: f10out
            character*80 :: fparam
            character*80 :: fmodel
            character*80 :: flines
            character*80 :: fslines
            character*80 :: fobs
            character*80 :: ftable
            character*80 :: fbarklem
            character*80 :: fbarklemuv
            character*80 :: atmosdir
            character*80 :: outdir
            character*60 :: moogpath
            character*20 :: moogversion
            character dimension(95,2),intent(c) :: names
            character*10 :: modtype
            character*7 :: control
            character*3 :: machine
            character*1 :: silent
            character dimension(2500,7),intent(c) :: damptype
            real*8 dimension(100,3) :: phi_opacity
            real*8 dimension(100,3) :: psi_opacity
            real*8 dimension(4) :: stokes
            real*8 :: continuum
            real*8 dimension(100) :: emission
            real*8 dimension(100) :: kref_knots
            real*8 dimension(100) :: kref_coeffs
            real*8 dimension(100) :: klam_knots
            real*8 dimension(100) :: klam_coeffs
            real*8 dimension(100) :: kaptot
            real*8 dimension(100) :: ktot_knots
            real*8 dimension(100) :: ktot_coeffs
            real*8 dimension(100) :: phii
            real*8 dimension(100) :: phii_knots
            real*8 dimension(100) :: phii_coeffs
            real*8 dimension(100) :: phiq
            real*8 dimension(100) :: phiq_knots
            real*8 dimension(100) :: phiq_coeffs
            real*8 dimension(100) :: phiu
            real*8 dimension(100) :: phiu_knots
            real*8 dimension(100) :: phiu_coeffs
            real*8 dimension(100) :: phiv
            real*8 dimension(100) :: phiv_knots
            real*8 dimension(100) :: phiv_coeffs
            real*8 dimension(100) :: psiq
            real*8 dimension(100) :: psiq_knots
            real*8 dimension(100) :: psiq_coeffs
            real*8 dimension(100) :: psiu
            real*8 dimension(100) :: psiu_knots
            real*8 dimension(100) :: psiu_coeffs
            real*8 dimension(100) :: psiv
            real*8 dimension(100) :: psiv_knots
            real*8 dimension(100) :: psiv_coeffs
            real*8 dimension(100) :: e_knots
            real*8 dimension(100) :: e_coeffs
            real*8 dimension(10000) :: taus
            real*8 dimension(10000) :: tlam
            real*8 dimension(10000) :: tlam_knots
            real*8 dimension(10000) :: tlam_coeffs
            real*8 dimension(10000) :: ttot
            real*8 dimension(10000) :: ttot_knots
            real*8 dimension(10000) :: ttot_coeffs
            real*8 dimension(10000) :: zdepth
            real*8 dimension(10000) :: z_knots
            real*8 dimension(10000) :: z_coeffs
            real*8 dimension(50000) :: strong
            real*8 dimension(50000) :: weak
            real*8 :: beta_strong
            real*8 :: beta_weak
            real*8 :: r_strong
            real*8 :: r_weak
            integer :: nz
            integer :: n_phii_knots
            integer :: n_phiq_knots
            integer :: n_phiu_knots
            integer :: n_phiv_knots
            integer :: n_psiq_knots
            integer :: n_psiu_knots
            integer :: n_psiv_knots
            integer :: n_kref_knots
            integer :: n_klam_knots
            integer :: n_ktot_knots
            integer :: n_e_knots
            integer :: n_z_knots
            integer :: n_tlam_knots
            integer :: n_ttot_knots
            integer :: nfangles
            integer :: nfstokesi
            integer :: nfstokesq
            integer :: nfstokesu
            integer :: nfstokesv
            integer :: nfcontinuum
            integer :: nw_lines
            integer :: ns_lines
            character*80 :: fangles
            character*80 :: fstokesi
            character*80 :: fstokesq
            character*80 :: fstokesu
            character*80 :: fstokesv
            character*80 :: fcontinuum
            intent(callback) fluxtracer
            external fluxtracer
            common /dummy/ dummy1,dummy2,dummy3,dummy4
            common /linex/ a,dopp,kapnu0,deltamj,crad,c4,gf,wave1,atom1,e,chi,amass,charge,d0,dampnum,gf1,width,abundout,widout,strength,rdmass,gambark,alpbark,wid1comp,kapnu,taunu,cd,sline,d,dellam,w,rwtab,gftab,gfhold,delta,start,sstop,step,oldstart,oldstop,oldstep,olddelta,dipstickwave,rwlow,rwhigh,rwstep,wavestep,cogatom,delwave,wave,waveold,st1,gammatot,gammav,gammas,gammar,viewang,lim1,lim2,mode,ndepths,ncurve,nlines,nstrong,lim1line,iaa,ibb,lim2line,ntabtot,group,iabatom,molflag,dostrong,gfstyle
            common /atmos/ t,theta,tkev,tlog,pgas,ne,nhtot,numdens,molweight,vturb,scont,kapref,kaplam,tauref,taulam,kaplamabs,kaplamsca,rho,rhox,xref,xdepth,elem,xabund,xabu,u,flux,fudge,wavref,abscale,deltaabund,ntau,jtau5,iunits,itru,iraf,modelnum,nfparam,nfmodel,nflines,nfslines,nfobs,nftable,nf1out,nf2out,nf3out,nf4out,nf5out,nf6out,nf7out,nf8out,nf9out,nf10out,nfbarklem,nfbarklemuv,modprintopt,molopt,linprintopt,linprintalt,fluxintopt,plotopt,dampingopt,specfileopt,linfileopt,printstrong,linecount,oldcount,scatopt
            common /angles/ inclination,clocking,position_angle,azimuth,longitude,b_sph,b_xyz,t_rho,t_eta,t_i,rotation_matrix,zeros,chi_angle,phi_angle,mus,nrings,ncells,testflag,diskflag
            common /charstuff/ f1out,f2out,f3out,f4out,f5out,f6out,f7out,f8out,f9out,f10out,fparam,fmodel,flines,fslines,fobs,ftable,fbarklem,fbarklemuv,atmosdir,outdir,moogpath,moogversion,names,modtype,control,machine,silent
            common /lindamp/ damptype
            common /stokesparams/ phi_opacity,psi_opacity,stokes,continuum,emission,kref_knots,kref_coeffs,klam_knots,klam_coeffs,kaptot,ktot_knots,ktot_coeffs,phii,phii_knots,phii_coeffs,phiq,phiq_knots,phiq_coeffs,phiu,phiu_knots,phiu_coeffs,phiv,phiv_knots,phiv_coeffs,psiq,psiq_knots,psiq_coeffs,psiu,psiu_knots,psiu_coeffs,psiv,psiv_knots,psiv_coeffs,e_knots,e_coeffs,taus,tlam,tlam_knots,tlam_coeffs,ttot,ttot_knots,ttot_coeffs,zdepth,z_knots,z_coeffs,strong,weak,beta_strong,beta_weak,r_strong,r_weak,nz,n_phii_knots,n_phiq_knots,n_phiu_knots,n_phiv_knots,n_psiq_knots,n_psiu_knots,n_psiv_knots,n_kref_knots,n_klam_knots,n_ktot_knots,n_e_knots,n_z_knots,n_tlam_knots,n_ttot_knots,nfangles,nfstokesi,nfstokesq,nfstokesu,nfstokesv,nfcontinuum,nw_lines,ns_lines,fangles,fstokesi,fstokesq,fstokesu,fstokesv,fcontinuum
        end subroutine stokesdipstick
    end interface 
end python module MoogStokesPy_Alpha

! This file was auto-generated with f2py (version:2).
! See http://cens.ioc.ee/projects/f2py2e/
